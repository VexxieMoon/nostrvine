---
title: "7:56:58 PM - October 25, 2025"
date: 2025-10-25T06:56:58.639Z
timestamp: 1761375418639
---

## Project Notes

Fixed critical bug preventing video discovery feeds from loading:

**Root Cause**: videoEventsProvider was blocking subscription when `appReady` gate was false (checking nostrReady). This prevented:
1. Loading cached videos from database
2. Starting any subscriptions at all  
3. Showing 900+ videos already in the database

**The Real Issues**:
1. Gate philosophy was wrong - we were blocking UI on Nostr readiness when we have a database-first architecture
2. VideoEventService can load from database even when Nostr isn't ready
3. Provider should ALWAYS subscribe and let VideoEventService handle queueing

**The Fix**:
Changed videoEventsProvider to ALWAYS call `_startSubscription()` regardless of gate states. VideoEventService already has defensive code to:
- Load cached videos from database immediately
- Queue Nostr subscriptions if service not ready
- Execute queue when Nostr connects

**Files Modified**:
1. `lib/providers/video_events_providers.dart` - Removed gate blocking, always subscribe
2. `lib/providers/readiness_gate_providers.dart` - Made NostrInitialization keepAlive (bonus fix for hot reload)
3. `lib/services/nostr_service_direct_web.dart` - Added onInitialized callback support (web compatibility)

**Key Insight from Rabble**: "With database-first architecture, we shouldn't lock UI waiting for Nostr - load from DB immediately, queue Nostr subscriptions for later."

This aligns with cache-first, network-later patterns common in modern apps.
